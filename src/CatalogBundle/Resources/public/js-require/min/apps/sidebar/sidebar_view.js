define(["app","tpl!apps/sidebar/templates/sidebar_template.tpl","tpl!apps/sidebar/templates/sidebar_no_sub_menu_template.tpl","tpl!apps/sidebar/templates/sidebar_sub_menu_template.tpl"],function(e,i,t,s){e.module("SidebarApp",function(e,n,o,l,a,d){e.NoSubMenuView=l.ItemView.extend({tagName:"li",template:t,events:{"click a":"electProduct"},electProduct:function(e){e.preventDefault(),e.stopPropagation(),this.trigger("sidebar:elect",this.model),"mobile"===n.Observer.Window.getStatus()?this.trigger("menu:close"):this.$el.parents("li").mouseout()}}),e.SidebarSubMenu=l.CompositeView.extend({tagName:"li",template:s,childViewContainer:"ul",childView:e.NoSubMenuView,initialize:function(){this.listenTo(n.Observer.Window,"window:desktop",this.setDesktopFunctions),this.listenTo(n.Observer.Window,"window:mobile",this.setMobileFunctions);var e=this.model.get("products"),i=new n.Entities.Products(e);this.model.set("products",i),this.collection=this.model.get("products")},setDesktopFunctions:function(){this.clearMobileFunctions();var e=this;this.$el.find("a.parent").click(function(i){i.preventDefault(),e.trigger("sidebar:elect",e.model),e.$el.mouseout()}),this.$el.hover(function(){clearTimeout(a.data(this,"timer")),a(this).find("> ul").stop(!0).slideDown(300)},function(){var e=a(this);a.data(this,"timer",setTimeout(function(){e.find("> ul").stop(!0).slideUp(300)},200))})},clearDesktopFunctions:function(){this.$el.find("a.parent").off(),this.$el.off()},setMobileFunctions:function(){this.clearDesktopFunctions(),this.$el.find("a.parent").click(function(e){e.preventDefault(),a(this).siblings("ul").slideToggle().toggleClass("is-opened")})},clearMobileFunctions:function(){this.$el.find("a.parent").off()}}),e.SidebarElements=l.CompositeView.extend({template:i,initialize:function(){this.currentSidebar=!1,this.on("childview:menu:close childview:childview:menu:close",function(){this.closeSidebar()})},tagName:"div",childViewContainer:"ul",getChildView:function(i){return 0===i.get("products").length?e.NoSubMenuView:e.SidebarSubMenu},events:{"click [data-toggle]":"toggleSidebar"},toggleSidebar:function(){0==this.currentSidebar?this.openSidebar():this.closeSidebar()},openSidebar:function(){this.currentSidebar=!0,this.$el.find(".left-sidebar").addClass("active"),this.$el.find(".left-sidebar > ul > li").addClass("is-expanded")},closeSidebar:function(){this.currentSidebar=!1;var e=this.$el.find(".left-sidebar"),i=e.find(" > ul > li");i.removeClass("is-expanded");var t=i.first(),s=t.css("transition-delay"),n=t.css("transition-duration"),o=1e3*(parseFloat(s)+parseFloat(n));setTimeout(function(){e.removeClass("active")},o),this.closeOpenedSubMenuMobile()},closeOpenedSubMenuMobile:function(){this.$el.find("a.parent").each(function(e,i){a(i).siblings("ul.is-opened").toggleClass("is-opened").slideToggle()})}})})});